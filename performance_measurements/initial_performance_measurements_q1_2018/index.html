<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.147.9">
    <meta name="description" content="">


    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Initial Performance Measurements (Q1 2018) :: dnsprivacy.org</title>

    
    <link href="/css/nucleus.css?1754296715" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1754296715" rel="stylesheet">
    <link href="/css/hybrid.css?1754296715" rel="stylesheet">
    <link href="/css/featherlight.min.css?1754296715" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1754296715" rel="stylesheet">
    <link href="/css/auto-complete.css?1754296715" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1754296715" rel="stylesheet">
    <link href="/css/theme.css?1754296715" rel="stylesheet">
    <link href="/css/tabs.css?1754296715" rel="stylesheet">
    <link href="/css/hugo-theme.css?1754296715" rel="stylesheet">
    
    <link href="/css/theme-blue.css?1754296715" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1754296715"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/performance_measurements/initial_performance_measurements_q1_2018/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href='/'>
  <p style="color: #fafafa;font-size:34px;font-weight: 400; font-family:Helvetica Neue, arial, courier;"><strong>DNS Privacy Project</strong></p>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1754296715"></script>
<script type="text/javascript" src="/js/auto-complete.js?1754296715"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/dnsprivacy.org\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1754296715"></script>

    
  </div>
  
    <section id="homelinks">
      <ul>
        <li>
            <a class="padding" href='/'><i class='fas fa-home'></i> Home</a>
        </li>
      </ul>
    </section>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/the_problem/" title="The Problem" class="dd-item
        
        
        
        ">
      <a href="/the_problem/">
          1. The Problem
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/the_solutions/" title="The Solutions" class="dd-item
        
        
        
        ">
      <a href="/the_solutions/">
          2. The Solutions
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/current_work/" title="Current Work" class="dd-item
        
        
        
        ">
      <a href="/current_work/">
          3. Current Work
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ietf_dns_privacy_tutorial/" title="IETF DNS Privacy Tutorial" class="dd-item
        
        
        
        ">
      <a href="/ietf_dns_privacy_tutorial/">
          4. IETF DNS Privacy Tutorial
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/adox_status_and_deployment/" title="ADoX Status and Deployment" class="dd-item
        
        
        
        ">
      <a href="/adox_status_and_deployment/">
          5. ADoX Status and Deployment
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/adox_status_and_deployment/ietf123sidemeetingminutes/" title="IETF 123 Side Meeting minutes" class="dd-item ">
        <a href="/adox_status_and_deployment/ietf123sidemeetingminutes/">
        5.1 IETF 123 Side Meeting minutes
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/public_resolvers/" title="Public Resolvers" class="dd-item
        
        
        
        ">
      <a href="/public_resolvers/">
          6. Public Resolvers
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/test_servers/" title="Test Servers" class="dd-item
        
        
        
        ">
      <a href="/test_servers/">
          7. Test Servers
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/test_servers/map_of_test_server_locations/" title="Map of test server locations" class="dd-item ">
        <a href="/test_servers/map_of_test_server_locations/">
        7.1. Map of test server locations
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/test_servers/monitoring/" title="dnsprivacy Monitoring" class="dd-item ">
        <a href="/test_servers/monitoring/">
        7.2. dnsprivacy Monitoring
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/test_servers/live_traffic_levels/" title="Live Traffic Levels" class="dd-item ">
        <a href="/test_servers/live_traffic_levels/">
        7.2. Live Traffic Levels
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/dns_privacy_clients/" title="DNS Privacy Clients" class="dd-item
        
        
        
        ">
      <a href="/dns_privacy_clients/">
          8. DNS Privacy Clients
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/dns_privacy_daemon_-_stubby/" title="DNS Privacy Daemon - Stubby" class="dd-item
        
        
        
        ">
      <a href="/dns_privacy_daemon_-_stubby/">
          9. DNS Privacy Daemon - Stubby
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/dns_privacy_daemon_-_stubby/about_stubby/" title="About Stubby" class="dd-item ">
        <a href="/dns_privacy_daemon_-_stubby/about_stubby/">
        9.1. About Stubby
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dns_privacy_daemon_-_stubby/configuring_stubby/" title="Configuring Stubby" class="dd-item ">
        <a href="/dns_privacy_daemon_-_stubby/configuring_stubby/">
        9.2. Configuring Stubby
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dns_privacy_daemon_-_stubby/stubby_manager_gui/" title="Stubby Manager GUI" class="dd-item ">
        <a href="/dns_privacy_daemon_-_stubby/stubby_manager_gui/">
        9.3. Stubby Manager GUI
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/dns_privacy_daemon_-_stubby/installation/" title="Installation" class="dd-item
        
        
        
        ">
      <a href="/dns_privacy_daemon_-_stubby/installation/">
          9.4. Installation
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/dns_privacy_daemon_-_stubby/installation/linux_from_source/" title="Linux From Source" class="dd-item ">
        <a href="/dns_privacy_daemon_-_stubby/installation/linux_from_source/">
        9.4.1. Linux From Source
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dns_privacy_daemon_-_stubby/installation/running_as_a_service_on_nix/" title="Running as a service on *nix" class="dd-item ">
        <a href="/dns_privacy_daemon_-_stubby/installation/running_as_a_service_on_nix/">
        9.4.2. Running as a service on *nix
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dns_privacy_daemon_-_stubby/installation/macos_homebrew/" title="MacOS Homebrew" class="dd-item ">
        <a href="/dns_privacy_daemon_-_stubby/installation/macos_homebrew/">
        9.4.3. MacOS Homebrew
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dns_privacy_daemon_-_stubby/installation/stubby_gui_for_macos/" title="Stubby GUI for macOS" class="dd-item ">
        <a href="/dns_privacy_daemon_-_stubby/installation/stubby_gui_for_macos/">
        9.4.4. Stubby GUI for macOS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/dns_privacy_daemon_-_stubby/installation/windows_installer_for_stubby/" title="Windows installer for Stubby" class="dd-item ">
        <a href="/dns_privacy_daemon_-_stubby/installation/windows_installer_for_stubby/">
        9.4.5. Windows installer for Stubby
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/implementation_status/" title="Implementation Status" class="dd-item
        
        
        
        ">
      <a href="/implementation_status/">
          10. Implementation Status
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/running_a_dns_privacy_server/" title="Running a DNS Privacy server" class="dd-item
        
        
        
        ">
      <a href="/running_a_dns_privacy_server/">
          11. Running a DNS Privacy server
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/running_a_dns_privacy_server/using_unbound/" title="Using Unbound" class="dd-item ">
        <a href="/running_a_dns_privacy_server/using_unbound/">
        11.1. Using Unbound
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/running_a_dns_privacy_server/using_knot_resolver/" title="Using Knot Resolver" class="dd-item ">
        <a href="/running_a_dns_privacy_server/using_knot_resolver/">
        11.2. Using Knot Resolver
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/running_a_dns_privacy_server/using_dnsdist/" title="Using dnsdist" class="dd-item ">
        <a href="/running_a_dns_privacy_server/using_dnsdist/">
        11.3. Using dnsdist
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/running_a_dns_privacy_server/using_a_tls_proxy/" title="Using a TLS proxy" class="dd-item
        
        
        
        ">
      <a href="/running_a_dns_privacy_server/using_a_tls_proxy/">
          11.4. Using a TLS proxy
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/running_a_dns_privacy_server/using_a_tls_proxy/building_haproxy_using_tlsv1_3/" title="Building HAProxy using TLSv1.3" class="dd-item ">
        <a href="/running_a_dns_privacy_server/using_a_tls_proxy/building_haproxy_using_tlsv1_3/">
        11.4.1. Building HAProxy using TLSv1.3
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/" title="Let&#39;s Encrypt Certificate renewal" class="dd-item
        
        
        
        ">
      <a href="/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/">
          11.5. Let&#39;s Encrypt Certificate renewal
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/automated_certificate_management_1/" title="Certificate management Method 1" class="dd-item ">
        <a href="/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/automated_certificate_management_1/">
        11.5.1. Certificate management Method 1
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/automated_certificate_management_2/" title="Certificate management method 2" class="dd-item ">
        <a href="/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/automated_certificate_management_2/">
        11.5.2. Certificate management method 2
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/running_a_dns_privacy_server/monitoring_privacy_servers/" title="Monitoring Privacy servers" class="dd-item ">
        <a href="/running_a_dns_privacy_server/monitoring_privacy_servers/">
        11.6. Monitoring Privacy servers
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/running_a_dns_privacy_server/best_current_practices/" title="Best Current Practices" class="dd-item
        
        
        
        ">
      <a href="/running_a_dns_privacy_server/best_current_practices/">
          11.7. Best Current Practices
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/running_a_dns_privacy_server/best_current_practices/comparison_of_policy_and_privacy_statements_2019/" title="Comparison of policy and privacy statements 2019" class="dd-item ">
        <a href="/running_a_dns_privacy_server/best_current_practices/comparison_of_policy_and_privacy_statements_2019/">
        11.7.1. Comparison of policy and privacy statements 2019
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/running_a_dns_privacy_server/best_current_practices/data_minimisation_of_dns_traffic/" title="Data minimisation of DNS traffic" class="dd-item ">
        <a href="/running_a_dns_privacy_server/best_current_practices/data_minimisation_of_dns_traffic/">
        11.7.2. Data minimisation of DNS traffic
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/encrypted-zone-transfer/" title="Encrypted Zone Transfer" class="dd-item
        
        
        
        ">
      <a href="/encrypted-zone-transfer/">
          12. Encrypted Zone Transfer
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/dns_privacy_reference_material/" title="DNS Privacy Reference Material" class="dd-item
        
        
        
        ">
      <a href="/dns_privacy_reference_material/">
          13. DNS Privacy Reference Material
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/performance_measurements/" title="Performance Measurements" class="dd-item
        parent
        
        
        ">
      <a href="/performance_measurements/">
          14. Performance Measurements
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/performance_measurements/initial_performance_measurements_q1_2018/" title="Initial Performance Measurements (Q1 2018)" class="dd-item active">
        <a href="/performance_measurements/initial_performance_measurements_q1_2018/">
        14.1. Initial Performance Measurements (Q1 2018)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/performance_measurements/follow-up_performance_measurements_q4_2108/" title="Follow-Up Performance Measurements (Q4 2108)" class="dd-item ">
        <a href="/performance_measurements/follow-up_performance_measurements_q4_2108/">
        14.2. Follow-Up Performance Measurements (Q4 2108)
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/performance_measurements/review_of_dns_and_http_pm_tools/" title="Review of DNS and HTTP PM Tools" class="dd-item ">
        <a href="/performance_measurements/review_of_dns_and_http_pm_tools/">
        14.3. Review of DNS and HTTP PM Tools
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/performance_measurements/proposal_for_new_performance_tool/" title="Proposal for New Performance Tool" class="dd-item ">
        <a href="/performance_measurements/proposal_for_new_performance_tool/">
        14.4. Proposal for New Performance Tool
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/ndss_dns_privacy_workshop/" title="NDSS DNS Privacy Workshop" class="dd-item
        
        
        
        ">
      <a href="/ndss_dns_privacy_workshop/">
          15. NDSS DNS Privacy Workshop
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
    <li data-nav-id="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/" title="2021 NDSS DNS Privacy Workshop" class="dd-item
        
        
        
        ">
      <a href="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/">
          15.1. 2021 NDSS DNS Privacy Workshop
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/call_for_papers/" title="Call for Papers" class="dd-item ">
        <a href="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/call_for_papers/">
        15.1.1. Call for Papers
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/workshop_notes/" title="Workshop Notes" class="dd-item
        
        
        
        ">
      <a href="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/workshop_notes/">
          15.1.2. Workshop Notes
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/workshop_notes/breakout_room_1/" title="Zoom Breakout Room 1: Measurement of Encrypted DNS" class="dd-item ">
        <a href="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/workshop_notes/breakout_room_1/">
        15.1.2.1. Zoom Breakout Room 1: Measurement of Encrypted DNS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/workshop_notes/breakout_room_2/" title="Zoom Breakout Room 2: Civil Society, Usability and DNS" class="dd-item ">
        <a href="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/workshop_notes/breakout_room_2/">
        15.1.2.2. Zoom Breakout Room 2: Civil Society, Usability and DNS
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/workshop_notes/breakout_room_3/" title="Zoom Breakout Room 3: Novel Work, ADoT and Future Research" class="dd-item ">
        <a href="/ndss_dns_privacy_workshop/2021_ndss_dns_privacy_workshop/workshop_notes/breakout_room_3/">
        15.1.2.3. Zoom Breakout Room 3: Novel Work, ADoT and Future Research
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
        
        </ul>
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ndss_dns_privacy_workshop/2018_ndss_dns_privacy_workshop/" title="2018 NDSS DNS Privacy Workshop" class="dd-item ">
        <a href="/ndss_dns_privacy_workshop/2018_ndss_dns_privacy_workshop/">
        15.2. 2018 NDSS DNS Privacy Workshop
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/ndss_dns_privacy_workshop/2017_ndss_dns_privacy_workshop/" title="2017 NDSS DNS Privacy Workshop" class="dd-item ">
        <a href="/ndss_dns_privacy_workshop/2017_ndss_dns_privacy_workshop/">
        15.3. 2017 NDSS DNS Privacy Workshop
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li>
                  <a class="padding" href="https://github.com/dnsprivacy"><i class='fab fa-github'></i> Github repo</a>
              </li>
          
              <li>
                  <a class="padding" href="https://www.youtube.com/channel/UCaJWMY-m9ktZIbUNMi0Eh9g/playlists"><i class='fab fa-youtube'></i> YouTube</a>
              </li>
          
              <li>
                  <a class="padding" href="https://sinodun.com"><i class='fas fa-bookmark'></i> Sinodun IT</a>
              </li>
          
              <li>
                  <a class="padding" href="https://www.nlnetlabs.nl/"><i class='fas fa-bookmark'></i> NLnetLabs</a>
              </li>
          
              <li>
                  <a class="padding" href="http://dnsprivacy.org/ndss_dns_privacy_workshop"><i class='fas fa-bookmark'></i> NDSS DNS Privacy Workshop</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn">Hugo Theme Learn</a> and <a href="https://gohugo.io/">Hugo</a></p>
<p>Built by <a href="sinodun.com">Sinodun Internet Technologies.</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>DNS Privacy Project</a> > <a href='/performance_measurements/'>Performance Measurements</a> > Initial Performance Measurements (Q1 2018)
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#initial-work">Initial work</a></li>
    <li><a href="#nameservers">Nameservers</a></li>
    <li><a href="#test-setup">Test setup</a>
      <ul>
        <li><a href="#software">Software</a>
          <ul>
            <li><a href="#test-parameters">Test parameters</a></li>
          </ul>
        </li>
        <li><a href="#hardware">Hardware</a></li>
        <li><a href="#os-tuning">OS tuning</a></li>
        <li><a href="#nameserver-configuration">Nameserver configuration</a></li>
      </ul>
    </li>
    <li><a href="#results">Results</a>
      <ul>
        <li><a href="#increasing-load">Increasing load</a>
          <ul>
            <li><a href="#udp-only">UDP only</a></li>
            <li><a href="#udp-vs-tcp">UDP vs TCP</a></li>
            <li><a href="#tcp-vs-tls">TCP vs TLS</a></li>
            <li><a href="#tcp-and-tls-as-a-percentage-of-udp">TCP and TLS as a percentage of UDP</a></li>
          </ul>
        </li>
        <li><a href="#vary-queries-per-connection">Vary queries per connection</a>
          <ul>
            <li><a href="#less-than-60000-queriesper-connection">Less than 60,000 queries per connection</a></li>
            <li><a href="#less-than-10000-queriesper-connection">Less than 10,000 queries per connection</a></li>
            <li><a href="#less-than-500-queries-per-connection">Less than 500 queries per connection</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#key-conclusions">Key conclusions</a></li>
    <li><a href="#todo-list">TODO list</a></li>
    <li><a href="#comments-on-test-stability">Comments on test stability</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Initial Performance Measurements (Q1 2018)
            </h1>
          

        


<div class="toc">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#initial-work">Initial work</a></li>
    <li><a href="#nameservers">Nameservers</a></li>
    <li><a href="#test-setup">Test setup</a>
      <ul>
        <li><a href="#software">Software</a>
          <ul>
            <li><a href="#test-parameters">Test parameters</a></li>
          </ul>
        </li>
        <li><a href="#hardware">Hardware</a></li>
        <li><a href="#os-tuning">OS tuning</a></li>
        <li><a href="#nameserver-configuration">Nameserver configuration</a></li>
      </ul>
    </li>
    <li><a href="#results">Results</a>
      <ul>
        <li><a href="#increasing-load">Increasing load</a>
          <ul>
            <li><a href="#udp-only">UDP only</a></li>
            <li><a href="#udp-vs-tcp">UDP vs TCP</a></li>
            <li><a href="#tcp-vs-tls">TCP vs TLS</a></li>
            <li><a href="#tcp-and-tls-as-a-percentage-of-udp">TCP and TLS as a percentage of UDP</a></li>
          </ul>
        </li>
        <li><a href="#vary-queries-per-connection">Vary queries per connection</a>
          <ul>
            <li><a href="#less-than-60000-queriesper-connection">Less than 60,000 queries per connection</a></li>
            <li><a href="#less-than-10000-queriesper-connection">Less than 10,000 queries per connection</a></li>
            <li><a href="#less-than-500-queries-per-connection">Less than 500 queries per connection</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#key-conclusions">Key conclusions</a></li>
    <li><a href="#todo-list">TODO list</a></li>
    <li><a href="#comments-on-test-stability">Comments on test stability</a></li>
  </ul>
</nav>
</div>
<p>Thanks to funding from the Open Technology Fund we have started work on
some performance measurements for various DNS Privacy implementations.
We report our initial results below.</p>
<h2 id="initial-work">Initial work</h2>
<p>The goal of the first phase of work it to get a general understanding of
the characteristics of the behaviour of several open source recursive
implemetnations under TCP and TLS load. The first measurements look at 2
aspects:</p>
<ul>
<li>How does TCP and TLS compare to UDP for a very small number of
client connections (1-16)</li>
<li>For a small number of connections how does performance vary with the
number of queries per connection</li>
</ul>
<p>We concentrate on relative performance rather than absolute values.</p>
<p>Results and configuration files can be found in the <a href="https://github.com/dnsprivacy/perfmeasurements_2018">Performance Testing
git
repo</a>.</p>
<p>We also presented this work at RIPE
76: <a href="https://ripe76.ripe.net/presentations/92-RIPE76_DNS_Privacy_measurements.pdf">Slides</a>, <a href="https://ripe76.ripe.net/archives/video/64">Video</a></p>

<div class="notices infoblock" ><p>Further follow up work can be found here: <a href="/performance_measurements/follow-up_performance_measurements_q4_2108/">Follow-up Performance
Measurements (Q4 2108)</a></p>
</div>

<h2 id="nameservers">Nameservers</h2>
<p>We tested four nameservers:</p>
<ul>
<li>Bind 9.12.1 (does not support TLS)</li>
<li>Unbound 1.7.0</li>
<li>Knot Resolver 2.3.0</li>
<li>dnsdist 1.3.0</li>
</ul>
<h2 id="test-setup">Test setup</h2>
<h3 id="software">Software</h3>
<p>We have used the well known
<a href="https://www.akamai.com/us/en/products/network-operator/measurement-tools.jsp">dnsperf</a>
from Nominum (now owned by Akamai) for the basis of our testing. </p>
<ul>
<li><strong>dnsperf</strong>: For UDP measurements to original tool from Nominum was
used</li>
<li><strong>dnsperf-tcp</strong>: For TCP measurements we used a fork from dnsperf
with added TCP support. <a href="https://github.com/Sinodun/dnsperf-tcp">The code is available on
github</a>. (This work was
funded by a grant from NLnet Foundation).</li>
<li><strong>dnsperf-tls</strong>: For TLS we had to re-factor dnsperf-tcp somewhat to
accommodate TLS support. We implemented this with both OpenSSL and
GnuTLS but saw no difference if performance of dnsperf and so we
used the version with OpenSSL (TLS 1.2) for the tests below. <a href="https://github.com/Sinodun/dnsperf-tcp/tree/feature/tls_openssl">This
code is also available on
github</a>.
We do note that we see some reduced performance for this version
when using TCP and TLS at very low queries per connection (we
believe due to limitations in the implementation because of how the
dnsperf threading model interacts with TLS read/writes). </li>
</ul>
<p>For future work we would like to create a bespoke testing tool designed
to specifically handle TCP and TLS. We have started a review of
<a href="/performance_measurements/review_of_dns_and_http_pm_tools/">existing testing tools here</a>.</p>
<p>We control the test runs from Jenkins and the scripts use a mix of bash,
awk and GNUplot to automatically generate plots of the results. </p>
<h4 id="test-parameters">Test parameters</h4>
<p>The results are the averages of 5 repeated runs each of 20 seconds with
dnsperf set to allow a total of 5000 outstanding queries. We note that
with a smaller number of outstanding queries we see quite different
results and above this number we see no differences. </p>


<img src="/attachments/14025132/14025129.png?width=50pc" />

<h3 id="hardware">Hardware</h3>
<p>Our current set up simply consists of one client machine and one
nameserver machine connected via a 10Gb switch:</p>


<img src="/attachments/14025132/14025123.png?width=25pc" />

<ul>
<li>
<p>The servers are both Supermicro Super Servers with a X10DRW-iT
Motherboard running BIOS v2.0b. Each has 2 Intel(R) Xeon(R) CPU
E5-2620 v4 @ 2.10GHz with 8 cores (16 threads).</p>
</li>
<li>
<p>They have an Intel Corporation 82574L Gigabit Network
Connection used for management and a dual port Intel Corporation
Ethernet Controller 10-Gigabit X540-AT2 for load testing. The two
10Gb interfaces are connected to a Netgear M4300-8X8F 10Gb switch.</p>
</li>
<li>
<p>The servers are running Ubuntu 18.04 LTS</p>
</li>
<li>
<p>The 10Gb ethernet controller (ixgbe) drivers have been upgraded to
the latest from
Intel <a href="https://downloadcenter.intel.com/download/14687/?product=60020">https://downloadcenter.intel.com/download/14687/?product=60020</a> version
5.3.3.</p>
</li>
</ul>
<p>See
below
for sample results on 18.04 without the spectre/meltdown fixes and
16.04.</p>
<h3 id="os-tuning">OS tuning</h3>
<p>Only minimal OS tuning was performed in these first tests:</p>
<ul>
<li>The number of file descriptors was raised by adding the following
to /etc/security/limits.conf</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-text" data-lang="text"><span style="display:flex;"><span>* soft nofile 100000
</span></span><span style="display:flex;"><span>* soft nofile 100000
</span></span></code></pre></div><ul>
<li>The following TCP TIME_WAIT and ephemeral port range changes were
made</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo sysctl -w net.ipv4.tcp_fin_timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>sudo sysctl -w net.ipv4.tcp_tw_reuse<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> 
</span></span><span style="display:flex;"><span>sudo sysctl -w net.ipv4.ip_local_port_range<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1025 65535&#34;</span>
</span></span></code></pre></div><h3 id="nameserver-configuration">Nameserver configuration</h3>
<p>The nameserver test machine is also is set up with NSD acting as a root
server that is able to answer all the questions in the
queryfile-example-current from Nominum. At the start of each test run
the recursive server cache was populated buy running the test queries
against the nameserver which was configured to fetch the answers from
the NSD instance. </p>
<p>The configurations used for each nameserver are available in <a href="https://github.com/dnsprivacy/perfmeasurements_2018">the git
repo</a>.</p>
<p>In each case the nameserver was locked to four cores to ensure the
client could saturate the nameserver. For Unbound, Knot resolver and
BIND the nameserver was configured to use 4 threads. dnsdist was
configured with 4 listeners and it should be noted that for TCP it uses
a different threading model where it spawns a separate thread for each
TCP connection it handles (creating them as required) so this most
probably explains the different behaviour of dnsdist observed below.</p>
<h2 id="results">Results</h2>
<p>The test results and a full set of plots can be found in <a href="https://github.com/dnsprivacy/perfmeasurements_2018">the git
repo</a>.</p>
<h3 id="increasing-load">Increasing load</h3>
<p>In the first test runs UDP, TCP and TLS were used to load the nameserver
as the number of dnsperf clients were increased from 1 to 16. For TCP
/TLS 20,000 queries per connection were sent so this is simulating
persistent connections to measure the throughput of TCP/TLS
connections. </p>
<h4 id="udp-only">UDP only</h4>
<p>We note that Unbound and dnsdist have the best performance here and BIND
and Knot Resolver have lower UPD performance. It is interesting to note
how flat the performance of BIND is compared to the other nameservers.</p>


<img src="/attachments/14025132/14025120.png?width=50pc" />

<h4 id="udp-vs-tcp">UDP vs TCP</h4>
<p>The surprising finding here is that with these specific test conditions
dnsdist shows much better TCP performance the UDP performance. But as
noted above it uses a very different threading model to the other
nameservers. The other nameservers all show a roughly similar decrease
in throughput over TCP of around 50%.</p>
<p>Note that Unbound serially processes the TCP queries on a connection
(i.e. it processes and sends a response to a TCP query before processing
the next query on the connection) instead of processing queries
concurrently (as specified in RFC7766). Work is in progress to change
this behaviour.  </p>


<img src="/attachments/14025132/14025121.png?width=50pc" />

<h4 id="tcp-vs-tls">TCP vs TLS</h4>
<p>(BIND does not support TLS yet). As expected there is a drop in
performance for TLS compared to TCP, of roughly 20-30%. </p>


<img src="/attachments/14025132/14025122.png?width=50pc" />

<h4 id="tcp-and-tls-as-a-percentage-of-udp">TCP and TLS as a percentage of UDP</h4>
<p>The plot below show the TCP/TLS performance as a percentage of the UDP
performance of the nameserver for loading with 8 clients (20,000 queries
per connection for TCP/TLS). </p>
<p>Whilst dnsdist show the best TCP performance, the relative drop in
performance for TLS compared to TCP is significant.</p>
<p>Unbound has the lowest TCP/TLS performance due to the lack of concurrent
processing, whereas BIND and Knot have comparable UDP vs TCP
performance. </p>


<img src="/attachments/14025132/14025119.png?width=50pc" />

<h3 id="vary-queries-per-connection">Vary queries per connection</h3>
<h4 id="less-than-60000-queriesper-connection">Less than 60,000 queries per connection</h4>
<p>Most of the nameservers show steady performance above 10,000 q/conn as
would be expected.</p>


<img src="/attachments/14025132/14025117.png?width=50pc" />

<h4 id="less-than-10000-queriesper-connection">Less than 10,000 queries per connection</h4>
<p>dnsdist has a relatively smooth decline in performance in this range,
Unbound and BIND are much flatter and decline only below ~1500 q/con.
It is noted that Knot appears very flat for TCP until much lower q/conn
(but not for TLS - we think this is due to limitations in our test tool
and are investigating).</p>


<img src="/attachments/14025132/14025118.png?width=50pc" />

<h4 id="less-than-500-queries-per-connection">Less than 500 queries per connection</h4>
<p>By examining the region below 500 in detail we see a marked difference
for Knot Resolver compared to the other nameservers. Unfortunately our
current test configuration encounters issues at low numbers of q/con so
we don&rsquo;t have numbers for below 60q/con. We are actively working to
resolve this and extend these plots. </p>


<img src="/attachments/14025132/14025115.png?width=50pc" />

<p>The plot below includes a purely theoretical extrapolation of Knot
resolver performance if amortization of the TCP handshake is the only
factor that degrades performance (handshakes are amortized at (N+1)/N
where N is the number of queries per connection).</p>


<img src="/attachments/14025132/14025116.png?width=50pc" />

<h2 id="key-conclusions">Key conclusions</h2>
<ul>
<li>Typically saw TCP was 40-50% of UDP throughput (except dnsdist,
which uses a different threading model and performed better)</li>
<li>TLS was 30-40% of UDP throughput</li>
<li>Varying the number of queries per connection (including low numbers)
shows amortisation of setup occurs between 100 or ~2000 q/conn
depending on the nameserver</li>
</ul>
<h2 id="todo-list">TODO list</h2>
<p>We clearly have more work to do to further investigate the behaviour we
seen This includes:</p>
<ul>
<li>Drill to lower q/conn for TCP and TLS</li>
<li>Dig into implementations….</li>
<li>Experiment with OS and nameserver tuning</li>
<li>Add more options: TFO, TLS Session Resumption, TLS 1.3,…</li>
<li>Compare to TLS proxy e.g. nginx, haproxy</li>
<li>Add concurrent processing to Unbound</li>
<li>Scale to MANY clients </li>
<li>Use new/different test tool?</li>
</ul>
<h2 id="comments-on-test-stability">Comments on test stability</h2>
<p>We do note that we see variations of the order of 10-15% when performing
identical test runs on the same setup at different times (e.g. on
following days with not change to the setup).</p>
<p>So each of the the data sets for a given setup is from sequential runs
of the test suite for each nameserver for better comparison.</p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1754296715"></script>
    <script src="/js/perfect-scrollbar.min.js?1754296715"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1754296715"></script>
    <script src="/js/jquery.sticky.js?1754296715"></script>
    <script src="/js/featherlight.min.js?1754296715"></script>
    <script src="/js/highlight.pack.js?1754296715"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1754296715"></script>
    <script src="/js/learn.js?1754296715"></script>
    <script src="/js/hugo-learn.js?1754296715"></script>
    
    

  </body>
</html>

