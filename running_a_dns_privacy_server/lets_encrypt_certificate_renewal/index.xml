<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Let&#39;s Encrypt Certificate renewal on dnsprivacy.org</title>
    <link>http://dnsprivacy.org/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/</link>
    <description>Recent content in Let&#39;s Encrypt Certificate renewal on dnsprivacy.org</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 21 Jul 2021 17:06:39 +0100</lastBuildDate>
    <atom:link href="http://dnsprivacy.org/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Certificate management Method 1</title>
      <link>http://dnsprivacy.org/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/automated_certificate_management_1/</link>
      <pubDate>Wed, 21 Jul 2021 17:02:51 +0100</pubDate>
      <guid>http://dnsprivacy.org/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/automated_certificate_management_1/</guid>
      <description>&lt;div class=&#34;toc&#34;&gt;&#xA;  &lt;nav id=&#34;TableOfContents&#34;&gt;&#xA;  &lt;ul&gt;&#xA;    &lt;li&gt;&lt;a href=&#34;#background&#34;&gt;Background&lt;/a&gt;&lt;/li&gt;&#xA;    &lt;li&gt;&lt;a href=&#34;#dns-setup&#34;&gt;DNS setup&lt;/a&gt;&#xA;      &lt;ul&gt;&#xA;        &lt;li&gt;&lt;a href=&#34;#cnames&#34;&gt;CNAMES&lt;/a&gt;&lt;/li&gt;&#xA;      &lt;/ul&gt;&#xA;    &lt;/li&gt;&#xA;    &lt;li&gt;&lt;a href=&#34;#configure-dehydrated&#34;&gt;Configure dehydrated&lt;/a&gt;&#xA;      &lt;ul&gt;&#xA;        &lt;li&gt;&lt;a href=&#34;#create-a-domains-file&#34;&gt;Create a domains file&lt;/a&gt;&lt;/li&gt;&#xA;        &lt;li&gt;&lt;a href=&#34;#write-a-hook-script&#34;&gt;Write a hook script&lt;/a&gt;&lt;/li&gt;&#xA;      &lt;/ul&gt;&#xA;    &lt;/li&gt;&#xA;    &lt;li&gt;&lt;a href=&#34;#write-a-script-to-download-the-certificates-to-your-dns-servers&#34;&gt;Write a script to download the certificates to your DNS servers&lt;/a&gt;&lt;/li&gt;&#xA;  &lt;/ul&gt;&#xA;&lt;/nav&gt;&#xA;&lt;/div&gt;&#xA;&lt;h2 id=&#34;background&#34;&gt;Background&lt;/h2&gt;&#xA;&lt;p&gt;At Sinodun we use&#xA;dehydrated &lt;a href=&#34;https://github.com/lukas2511/dehydrated&#34;&gt;https://github.com/lukas2511/dehydrated&lt;/a&gt; to manage our&#xA;certificates. Also we use the &lt;a href=&#34;https://tools.ietf.org/html/draft-ietf-acme-acme-09#section-8.5&#34;&gt;dns-01&#xA;challenge&lt;/a&gt; to&#xA;renew them.&lt;/p&gt;&#xA;&lt;p&gt;Since we run multiple DNS-over-TLS servers, the method used here employs&#xA;a single &amp;lsquo;certificate management&amp;rsquo; server to renew the certificates,&#xA;update the zone with the dns-01 challenge and make the renewed&#xA;certificates available via ftp. A script is then run on each DNS server&#xA;to download any new certificates using ftp to each server and restart&#xA;the DNS service. In this example we use TLS proxies in front of BIND, or&#xA;Knot resolver.&lt;/p&gt;</description>
    </item>
    <item>
      <title>Certificate management method 2</title>
      <link>http://dnsprivacy.org/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/automated_certificate_management_2/</link>
      <pubDate>Wed, 21 Jul 2021 17:06:39 +0100</pubDate>
      <guid>http://dnsprivacy.org/running_a_dns_privacy_server/lets_encrypt_certificate_renewal/automated_certificate_management_2/</guid>
      <description>&lt;p&gt;This page is assumes using OpenDNSSEC to sign zones. Thanks to Willem&#xA;Toorop and Ralph Dolmans at NLnet Labs for developing this automated&#xA;solution!&lt;/p&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;An example configuration file is:&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CA=&amp;#34;https://acme-v01.api.letsencrypt.org/directory&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;#CA=&amp;#34;https://acme-staging.api.letsencrypt.org/directory&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;LICENSE=&amp;#34;https://letsencrypt.org/documents/LE-SA-v1.1.1-August-1-2016.pdf&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CERTDIR=/usr/local/etc/dehydrated/certs&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CHALLENGETYPE=&amp;#34;dns-01&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;HOOK=/usr/local/etc/dehydrated/dnshook.sh&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PRIVATE_KEY_RENEW=&amp;#34;no&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;PRIVATE_KEY_ROLLOVER=&amp;#34;no&amp;#34;&#xA;&lt;/span&gt;&lt;/span&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;CONTACT_EMAIL=alice@example.com&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;Private keys are then stored in&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;/usr/local/etc/dehydrated/certs/&amp;lt;domain&amp;gt;/privkey.pem&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;&#xA;&lt;li&gt;&#xA;&lt;p&gt;The SubjectAltNames are then enumerated in the file&lt;/p&gt;&#xA;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;display:flex;&#34;&gt;&lt;span&gt;/usr/local/etc/dehydrated/domains.txt&#xA;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;Add one line in this for each &amp;lsquo;group&amp;rsquo; of names that should share a&#xA;certificate e.g&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
